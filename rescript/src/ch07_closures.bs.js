// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Belt_List = require("rescript/lib/js/belt_List.js");

function getNum(myType) {
  if (myType.TAG === /* NumV */0) {
    return myType._0;
  }
  throw {
        RE_EXN_ID: "Not_found",
        Error: new Error()
      };
}

function isNum(x) {
  if (x.TAG === /* NumV */0) {
    return true;
  } else {
    return false;
  }
}

function closVArg(x) {
  if (x.TAG !== /* NumV */0) {
    return x._0;
  }
  throw {
        RE_EXN_ID: "Not_found",
        Error: new Error()
      };
}

function closVBody(x) {
  if (x.TAG !== /* NumV */0) {
    return x._1;
  }
  throw {
        RE_EXN_ID: "Not_found",
        Error: new Error()
      };
}

function closVEnv(x) {
  if (x.TAG !== /* NumV */0) {
    return x._2;
  }
  throw {
        RE_EXN_ID: "Not_found",
        Error: new Error()
      };
}

var Types = {
  getNum: getNum,
  isNum: isNum,
  closVArg: closVArg,
  closVBody: closVBody,
  closVEnv: closVEnv
};

function lookup(n, _env) {
  while(true) {
    var env = _env;
    if (env) {
      var a = env.hd;
      if (a._0 === n) {
        return a._1;
      }
      _env = env.tl;
      continue ;
    }
    throw {
          RE_EXN_ID: "Not_found",
          Error: new Error()
        };
  };
}

function numPlus(l, r) {
  if (isNum(l) && isNum(r)) {
    return {
            TAG: /* NumV */0,
            _0: getNum(l) + getNum(r) | 0
          };
  }
  throw {
        RE_EXN_ID: "Not_found",
        Error: new Error()
      };
}

function numMult(l, r) {
  if (isNum(l) && isNum(r)) {
    return {
            TAG: /* NumV */0,
            _0: Math.imul(getNum(l), getNum(r))
          };
  }
  throw {
        RE_EXN_ID: "Not_found",
        Error: new Error()
      };
}

function interp(_exp, _env) {
  while(true) {
    var env = _env;
    var exp = _exp;
    switch (exp.TAG | 0) {
      case /* NumC */0 :
          return {
                  TAG: /* NumV */0,
                  _0: exp._0
                };
      case /* IdC */1 :
          return lookup(exp._0, env);
      case /* LamC */2 :
          return {
                  TAG: /* ClosV */1,
                  _0: exp._0,
                  _1: exp._1,
                  _2: env
                };
      case /* AppC */3 :
          var fValue = interp(exp._0, env);
          _env = Belt_List.add(closVEnv(fValue), /* Bind */{
                _0: closVArg(fValue),
                _1: interp(exp._1, env)
              });
          _exp = closVBody(fValue);
          continue ;
      case /* PlusC */4 :
          return numPlus(interp(exp._0, env), interp(exp._1, env));
      case /* MultC */5 :
          return numMult(interp(exp._0, env), interp(exp._1, env));
      
    }
  };
}

function desugar(ars) {
  switch (ars.TAG | 0) {
    case /* NumS */0 :
        return {
                TAG: /* NumC */0,
                _0: ars._0
              };
    case /* PlusS */1 :
        return {
                TAG: /* PlusC */4,
                _0: desugar(ars._0),
                _1: desugar(ars._1)
              };
    case /* MultS */2 :
        return {
                TAG: /* MultC */5,
                _0: desugar(ars._0),
                _1: desugar(ars._1)
              };
    case /* MinusS */3 :
        return {
                TAG: /* PlusC */4,
                _0: desugar(ars._0),
                _1: {
                  TAG: /* MultC */5,
                  _0: {
                    TAG: /* NumC */0,
                    _0: -1
                  },
                  _1: desugar(ars._1)
                }
              };
    case /* SquareS */4 :
        var l = ars._0;
        return {
                TAG: /* PlusC */4,
                _0: desugar(l),
                _1: desugar(l)
              };
    
  }
}

var fd1 = {
  TAG: /* LamC */2,
  _0: "x",
  _1: {
    TAG: /* PlusC */4,
    _0: {
      TAG: /* IdC */1,
      _0: "x"
    },
    _1: {
      TAG: /* NumC */0,
      _0: 5
    }
  }
};

var an = interp({
      TAG: /* PlusC */4,
      _0: {
        TAG: /* MultC */5,
        _0: {
          TAG: /* AppC */3,
          _0: fd1,
          _1: {
            TAG: /* NumC */0,
            _0: 2
          }
        },
        _1: {
          TAG: /* NumC */0,
          _0: 4
        }
      },
      _1: {
        TAG: /* NumC */0,
        _0: 3
      }
    }, /* [] */0);

console.log(getNum(an));

var an1 = interp(desugar({
          TAG: /* PlusS */1,
          _0: {
            TAG: /* SquareS */4,
            _0: {
              TAG: /* NumS */0,
              _0: 8
            }
          },
          _1: {
            TAG: /* NumS */0,
            _0: 3
          }
        }), /* [] */0);

var mtEnv = /* [] */0;

var extendEnv = Belt_List.add;

var fd2 = {
  TAG: /* LamC */2,
  _0: "y",
  _1: {
    TAG: /* AppC */3,
    _0: {
      TAG: /* LamC */2,
      _0: "x",
      _1: {
        TAG: /* PlusC */4,
        _0: {
          TAG: /* IdC */1,
          _0: "x"
        },
        _1: {
          TAG: /* NumC */0,
          _0: 5
        }
      }
    },
    _1: {
      TAG: /* NumC */0,
      _0: 5
    }
  }
};

var fd3 = {
  TAG: /* LamC */2,
  _0: "_",
  _1: {
    TAG: /* NumC */0,
    _0: 5
  }
};

exports.Types = Types;
exports.mtEnv = mtEnv;
exports.extendEnv = extendEnv;
exports.lookup = lookup;
exports.numPlus = numPlus;
exports.numMult = numMult;
exports.interp = interp;
exports.desugar = desugar;
exports.fd1 = fd1;
exports.fd2 = fd2;
exports.fd3 = fd3;
exports.an = an;
exports.an1 = an1;
/* an Not a pure module */
